!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports):"function"==typeof define&&define.amd?define("@baidu/clickstream-sdk/lib/index",["exports"],t):t((e="undefined"!=typeof globalThis?globalThis:e||self).Clickstream={})}(this,function(e){"use strict";function t(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function n(e){for(var n=1;n<arguments.length;n++){var r=null!=arguments[n]?arguments[n]:{};
n%2?t(Object(r),!0).forEach(function(t){u(e,t,r[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):t(Object(r)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))})}return e}function r(e){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")
}function o(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function a(e,t,n){return t&&o(e.prototype,t),n&&o(e,n),e}function u(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function c(e,t){return e(t={exports:{}},t.exports),t.exports}function s(e){var t,n;this.promise=new e(function(e,r){if(void 0!==t||void 0!==n)throw TypeError("Bad Promise constructor");
t=e,n=r}),this.resolve=Z(t),this.reject=Z(n)}function l(e){if((e=e||{}).url){var t="jsonp_"+Math.ceil(1e4*Math.random()),n=document.getElementsByTagName("head")[0];e.data.callback=t;var r=function(e){var t=[];for(var n in e)t.push(encodeURIComponent(n)+"="+encodeURIComponent(e[n]));return t.join("&")}(e.data),i=document.createElement("script"),o=null;n.appendChild(i),window[t]=function(n){o&&clearTimeout(o),window[t]=null,e.success&&e.success(n)},i.src=e.url+"?"+r,e.time&&(o=setTimeout(function(){window[t]=null,n.removeChild(i),e.error&&e.error({message:"超时"})
},e.time))}else console.warn("jsonp参数不合法")}function f(e,t,n){e.getconfig?l({url:"https://cstm.baidu.com/log/getconf",data:e,success:function(e){n&&n(e.data||[])},error:function(e){console.log("获取自动打点流配置失败",e)}}):function(e){var t=window.page||{},n="httplog_"+(new Date).getTime(),r=t[n]=new Image;r.onload=r.onerror=function(){t[n]=null},r.src=e,r=null}(t+"?params="+encodeURIComponent(e))}function d(e){var t;if("string"==typeof e||"number"==typeof e||"boolean"==typeof e||"function"==typeof e||void 0===e||null==e)t=e;
else if(Array.isArray(e)){t=[];for(var n=0;n<e.length;n++)t[n]=d(e[n])}else if("object"===r(e))for(var i in t={},e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=d(e[i]));else t=e;return t}function p(e){return"[object Object]"===Object.prototype.toString.call(e)}function h(e){for(var t in e)e[t]=Array.isArray(e[t])||p(e[t])?h(e[t]):String(e[t]);return JSON.stringify(e)}function g(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(e){var t=16*Math.random()|0;return("x"===e?t:3&t|8).toString(16)
})}function m(e,t){var n=new RegExp("(^|&)"+t+"=([^&]*)(&|$)"),r=e.split("?")[1]&&e.split("?")[1].match(n);return null!=r?unescape(r[2]):null}function v(e){var t,n,r=e&&e.split("/")[2],i="";if(r)if(r.indexOf("baike.baidu")>-1||r.indexOf("baike.otp.baidu")>-1)(i=y("channel"))||(i="NA");else if(Ti[r])b("channel",i=Ti[r]);else{for(var o=0;o<Oi.length;o++)if(r.indexOf(Oi[o].domain)>-1){i=Oi[o].channel;break}""===i&&(i=r),b("channel",i)}else t="channel",(n=new Date).setTime(n.getTime()-1),document.cookie=t+"=;domain="+document.domain+";path=/;expires="+n.toGMTString(),i="NA";
return i}function y(e){var t=new RegExp("(^| )"+e+"=([^;]*)(;|$)"),n=document.cookie&&document.cookie.match(t);return null!=n?unescape(n[2]):null}function b(e,t){var n=new Date;n.setTime(n.getTime()+31536e6),document.cookie=e+"="+t+";domain="+document.domain+";path=/;expires="+n.toGMTString()}function w(e,t,n){if(!p(e))return n&&console.warn("检测必填字段的数据不是object"),!1;for(var r=0;r<t.length;r++)if(void 0===e[t[r]])return n&&console.warn("必填字段",t,"缺少字段"+t[r]),!1;return!0}function x(e){var t=e.baseParam,r=e.pt,i=e.ptInfo,o=e.isDebug,a={setconfig:1,common:n(n({},t),{},{platform:r,ptInfo:i})};
return o&&(console.log("logConfig"),console.log(a)),h(d(a))}function _(e,t,r,i){if("getconfig"===r)return i?{getconfig:h(d(t.getconfig))}:h(d(t));var o=e.baseParam,a=e.pt,u=e.ptInfo,c=e.isDebug;if(!r||!Li[r])return c&&console.warn("发送的type不对，当前type是"+r),"noType";if(!w(t,Li[r].required,c))return c&&console.warn("发送"+r+"类型的必填信息不全"),"noRequired";var s=d(t),l={},f={},p={},g={},m={},v={},y={};s.ruleId&&(y.rule_id=s.ruleId,delete s.ruleId);var b={};for(var x in s)Li[r].keys.indexOf(x)>-1?(l[x]=s[x],delete s[x]):"ext"===x?(f=s[x],delete s[x]):0===x.indexOf("f_")?(p[x]=s[x],delete s[x]):0===x.indexOf("c_")?(g[x]=s[x],delete s[x]):Lr.indexOf(x)>-1?(m[x]=s[x],delete s[x]):ji[a].indexOf(x)>-1?(v[x]=s[x],delete s[x]):(b[x]=s[x],delete s[x]);
if(Li[r].ename&&(l.ename=l[Li[r].ename]),i){var _=n({setconfig:0,common:n(n(n({},o),{},{timestamp:(new Date).getTime()},m),{},{platform:a,ptInfo:n(n({},u),v)}),action:n(n({},Li[r].default),{},{actionInfo:l,ext:f,commonExt:p,customExt:g,customUser:b})},y);return c&&(console.log("logHttp"),console.log(_)),h(d(_))}var k=n({setconfig:0,common:n(n({timestamp:(new Date).getTime()},m),{},{ptInfo:v}),action:n(n({},Li[r].default),{},{actionInfo:l,ext:f,commonExt:p,customExt:g,customUser:b})},y);return c&&(console.log("logWebsocket"),console.log(k)),h(d(k))
}function k(e){return!!e&&"object"===r(e)&&1===e.nodeType}function E(e,t){if(/^\d+%$/.test(e)){var n=parseInt(e,10)/100;e=Math.round(t*n)}else e=parseInt(e,10);return e}function S(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r=e.getBoundingClientRect(),i=r.top,o=r.bottom,a=r.height,u=r.left,c=r.right,s=r.width;if(0===s||0===a)return!1;var l=E(t,a),f=E(n,s),d=window.innerWidth||document.documentElement.clientWidth,p=window.innerHeight||document.documentElement.clientHeight,h=i>=0&&p>=i+l,g=o-l>=0&&p>=o,m=u>=0&&d>=u+f,v=c-f>=0&&d>=c,y=(h||g)&&(m||v);
return y}function P(e,t){var n=Ki(e.selector);if(0!==n.length){var r=n[0],i=e.ruleId,o=e.element,a=e.page,u=e.attribute,c={ruleId:i,element:o,page:a},s=u&&JSON.parse(u);if(s)for(var l in s){var f=r.getAttribute(l);null!==f&&(c[s[l]]=f)}S(r)?t(c,"viewEl"):Qi.addListener(r,function d(){Qi.removeListener(r,d),t(c,"viewEl")})}else Yi.push(e)}function I(e,t){var n=Ki(e.selector);if(0!==n.length){var r=n[0],i=e.ruleId,o=e.element,a=e.page,u=e.attribute,c={ruleId:i,element:o,page:a},s=u&&JSON.parse(u);if(s)for(var l in s){var f=r.getAttribute(l);
null!==f&&(c[s[l]]=f)}t(c,"viewElDraw")}else eo.push(e)}function A(e,t){var n=t.parentNode;return n?e.indexOf(n)>-1?n:A(e,n):null}function C(e){var t="";if(e&&e.stack){t=e.stack.replace(/\n/gi,"").split(/\bat\b/).slice(0,9).join("@").replace(/\?[^:]+/gi,"");var n=e.toString();t.indexOf(n)<0&&(t=n+"@"+t)}return encodeURIComponent(t)}var D=c(function(e){var t=e.exports="undefined"!=typeof window&&window.Math==Math?window:"undefined"!=typeof self&&self.Math==Math?self:Function("return this")();"number"==typeof __g&&(__g=t)
}),T=c(function(e){var t=e.exports={version:"2.6.11"};"number"==typeof __e&&(__e=t)});T.version;var O=function(e){return"object"==typeof e?null!==e:"function"==typeof e},j=function(e){if(!O(e))throw TypeError(e+" is not an object!");return e},N=function(e){try{return!!e()}catch(e){return!0}},L=!N(function(){return 7!=Object.defineProperty({},"a",{get:function(){return 7}}).a}),R=D.document,q=O(R)&&O(R.createElement),z=function(e){return q?R.createElement(e):{}},M=!L&&!N(function(){return 7!=Object.defineProperty(z("div"),"a",{get:function(){return 7
}}).a}),W=function(e,t){if(!O(e))return e;var n,r;if(t&&"function"==typeof(n=e.toString)&&!O(r=n.call(e)))return r;if("function"==typeof(n=e.valueOf)&&!O(r=n.call(e)))return r;if(!t&&"function"==typeof(n=e.toString)&&!O(r=n.call(e)))return r;throw TypeError("Can't convert object to primitive value")},F=Object.defineProperty,B={f:L?Object.defineProperty:function(e,t,n){if(j(e),t=W(t,!0),j(n),M)try{return F(e,t,n)}catch(e){}if("get"in n||"set"in n)throw TypeError("Accessors not supported!");return"value"in n&&(e[t]=n.value),e
}},$=function(e,t){return{enumerable:!(1&e),configurable:!(2&e),writable:!(4&e),value:t}},G=L?function(e,t,n){return B.f(e,t,$(1,n))}:function(e,t,n){return e[t]=n,e},H={}.hasOwnProperty,V=function(e,t){return H.call(e,t)},U=0,J=Math.random(),K=function(e){return"Symbol(".concat(void 0===e?"":e,")_",(++U+J).toString(36))},X=c(function(e){var t="__core-js_shared__",n=D[t]||(D[t]={});(e.exports=function(e,t){return n[e]||(n[e]=void 0!==t?t:{})})("versions",[]).push({version:T.version,mode:"global",copyright:"© 2019 Denis Pushkarev (zloirock.ru)"})
}),Q=X("native-function-to-string",Function.toString),Y=c(function(e){var t=K("src"),n="toString",r=(""+Q).split(n);T.inspectSource=function(e){return Q.call(e)},(e.exports=function(e,n,i,o){var a="function"==typeof i;a&&(V(i,"name")||G(i,"name",n)),e[n]!==i&&(a&&(V(i,t)||G(i,t,e[n]?""+e[n]:r.join(String(n)))),e===D?e[n]=i:o?e[n]?e[n]=i:G(e,n,i):(delete e[n],G(e,n,i)))})(Function.prototype,n,function(){return"function"==typeof this&&this[t]||Q.call(this)})}),Z=function(e){if("function"!=typeof e)throw TypeError(e+" is not a function!");
return e},et=function(e,t,n){if(Z(e),void 0===t)return e;switch(n){case 1:return function(n){return e.call(t,n)};case 2:return function(n,r){return e.call(t,n,r)};case 3:return function(n,r,i){return e.call(t,n,r,i)}}return function(){return e.apply(t,arguments)}},tt=function(e,t,n){var r,i,o,a,u=e&tt.F,c=e&tt.G,s=e&tt.S,l=e&tt.P,f=e&tt.B,d=c?D:s?D[t]||(D[t]={}):(D[t]||{}).prototype,p=c?T:T[t]||(T[t]={}),h=p.prototype||(p.prototype={});for(r in c&&(n=t),n)o=((i=!u&&d&&void 0!==d[r])?d:n)[r],a=f&&i?et(o,D):l&&"function"==typeof o?et(Function.call,o):o,d&&Y(d,r,o,e&tt.U),p[r]!=o&&G(p,r,a),l&&h[r]!=o&&(h[r]=o)
};D.core=T,tt.F=1,tt.G=2,tt.S=4,tt.P=8,tt.B=16,tt.W=32,tt.U=64,tt.R=128;var nt=tt,rt=function(e,t,n){var r=void 0===n;switch(t.length){case 0:return r?e():e.call(n);case 1:return r?e(t[0]):e.call(n,t[0]);case 2:return r?e(t[0],t[1]):e.call(n,t[0],t[1]);case 3:return r?e(t[0],t[1],t[2]):e.call(n,t[0],t[1],t[2]);case 4:return r?e(t[0],t[1],t[2],t[3]):e.call(n,t[0],t[1],t[2],t[3])}return e.apply(n,t)},it=[].slice,ot={},at=function(e,t,n){if(!(t in ot)){for(var r=[],i=0;t>i;i++)r[i]="a["+i+"]";ot[t]=Function("F,a","return new F("+r.join(",")+")")
}return ot[t](e,n)},ut=Function.bind||function(e){var t=Z(this),n=it.call(arguments,1),r=function(){var i=n.concat(it.call(arguments));return this instanceof r?at(t,i.length,i):rt(t,i,e)};return O(t.prototype)&&(r.prototype=t.prototype),r};nt(nt.P,"Function",{bind:ut});var ct={}.toString,st=function(e){return ct.call(e).slice(8,-1)},lt=Object("z").propertyIsEnumerable(0)?Object:function(e){return"String"==st(e)?e.split(""):Object(e)},ft=function(e){if(null==e)throw TypeError("Can't call method on  "+e);
return e},dt=function(e){return lt(ft(e))},pt=Math.ceil,ht=Math.floor,gt=function(e){return isNaN(e=+e)?0:(e>0?ht:pt)(e)},mt=Math.min,vt=function(e){return e>0?mt(gt(e),9007199254740991):0},yt=Math.max,bt=Math.min,wt=function(e,t){return(e=gt(e))<0?yt(e+t,0):bt(e,t)},xt=function(e){return function(t,n,r){var i,o=dt(t),a=vt(o.length),u=wt(r,a);if(e&&n!=n){for(;a>u;)if((i=o[u++])!=i)return!0}else for(;a>u;u++)if((e||u in o)&&o[u]===n)return e||u||0;return!e&&-1}},_t=function(e,t){return!!e&&N(function(){t?e.call(null,function(){},1):e.call(null)
})},kt=xt(!1),Et=[].indexOf,St=!!Et&&1/[1].indexOf(1,-0)<0;nt(nt.P+nt.F*(St||!_t(Et)),"Array",{indexOf:function(e){return St?Et.apply(this,arguments)||0:kt(this,e,arguments[1])}});var Pt=Array.isArray||function(e){return"Array"==st(e)};nt(nt.S,"Array",{isArray:Pt});var It=function(e){return Object(ft(e))},At=c(function(e){var t=X("wks"),n=D.Symbol,r="function"==typeof n;(e.exports=function(e){return t[e]||(t[e]=r&&n[e]||(r?n:K)("Symbol."+e))}).store=t}),Ct=At("species"),Dt=function(e,t){return new(function(e){var t;
return Pt(e)&&("function"!=typeof(t=e.constructor)||t!==Array&&!Pt(t.prototype)||(t=void 0),O(t)&&null===(t=t[Ct])&&(t=void 0)),void 0===t?Array:t}(e))(t)},Tt=function(e,t){var n=1==e,r=2==e,i=3==e,o=4==e,a=6==e,u=5==e||a,c=t||Dt;return function(t,s,l){for(var f,d,p=It(t),h=lt(p),g=et(s,l,3),m=vt(h.length),v=0,y=n?c(t,m):r?c(t,0):void 0;m>v;v++)if((u||v in h)&&(d=g(f=h[v],v,p),e))if(n)y[v]=d;else if(d)switch(e){case 3:return!0;case 5:return f;case 6:return v;case 2:y.push(f)}else if(o)return!1;return a?-1:i||o?o:y
}},Ot=Tt(0),jt=_t([].forEach,!0);nt(nt.P+nt.F*!jt,"Array",{forEach:function(e){return Ot(this,e,arguments[1])}});var Nt=At("toStringTag"),Lt="Arguments"==st(function(){return arguments}()),Rt=function(e){var t,n,r;return void 0===e?"Undefined":null===e?"Null":"string"==typeof(n=function(e,t){try{return e[t]}catch(e){}}(t=Object(e),Nt))?n:Lt?st(t):"Object"==(r=st(t))&&"function"==typeof t.callee?"Arguments":r},qt={};qt[At("toStringTag")]="z",qt+""!="[object z]"&&Y(Object.prototype,"toString",function(){return"[object "+Rt(this)+"]"
},!0);var zt,Mt,Wt,Ft=function(e,t,n,r){try{return r?t(j(n)[0],n[1]):t(n)}catch(t){var i=e.return;throw void 0!==i&&j(i.call(e)),t}},Bt={},$t=At("iterator"),Gt=Array.prototype,Ht=At("iterator"),Vt=T.getIteratorMethod=function(e){return null!=e?e[Ht]||e["@@iterator"]||Bt[Rt(e)]:void 0},Ut=c(function(e){var t={},n={},r=e.exports=function(e,r,i,o,a){var u,c,s,l,f,d=a?function(){return e}:Vt(e),p=et(i,o,r?2:1),h=0;if("function"!=typeof d)throw TypeError(e+" is not iterable!");if(void 0===(f=d)||Bt.Array!==f&&Gt[$t]!==f){for(s=d.call(e);!(c=s.next()).done;)if((l=Ft(s,p,c.value,r))===t||l===n)return l
}else for(u=vt(e.length);u>h;h++)if((l=r?p(j(c=e[h])[0],c[1]):p(e[h]))===t||l===n)return l};r.BREAK=t,r.RETURN=n}),Jt=At("species"),Kt=function(e,t){var n,r=j(e).constructor;return void 0===r||null==(n=j(r)[Jt])?t:Z(n)},Xt=D.document,Qt=Xt&&Xt.documentElement,Yt=D.process,Zt=D.setImmediate,en=D.clearImmediate,tn=D.MessageChannel,nn=D.Dispatch,rn=0,on={},an="onreadystatechange",un=function(){var e=+this;if(on.hasOwnProperty(e)){var t=on[e];delete on[e],t()}},cn=function(e){un.call(e.data)};Zt&&en||(Zt=function(e){for(var t=[],n=1;arguments.length>n;)t.push(arguments[n++]);
return on[++rn]=function(){rt("function"==typeof e?e:Function(e),t)},zt(rn),rn},en=function(e){delete on[e]},"process"==st(Yt)?zt=function(e){Yt.nextTick(et(un,e,1))}:nn&&nn.now?zt=function(e){nn.now(et(un,e,1))}:tn?(Wt=(Mt=new tn).port2,Mt.port1.onmessage=cn,zt=et(Wt.postMessage,Wt,1)):D.addEventListener&&"function"==typeof postMessage&&!D.importScripts?(zt=function(e){D.postMessage(e+"","*")},D.addEventListener("message",cn,!1)):zt=an in z("script")?function(e){Qt.appendChild(z("script")).onreadystatechange=function(){Qt.removeChild(this),un.call(e)
}}:function(e){setTimeout(et(un,e,1),0)});var sn={set:Zt,clear:en},ln=sn.set,fn=D.MutationObserver||D.WebKitMutationObserver,dn=D.process,pn=D.Promise,hn="process"==st(dn),gn={f:function(e){return new s(e)}},mn=function(e){try{return{e:!1,v:e()}}catch(e){return{e:!0,v:e}}},vn=D.navigator,yn=vn&&vn.userAgent||"",bn=B.f,wn=At("toStringTag"),xn=function(e,t,n){e&&!V(e=n?e:e.prototype,wn)&&bn(e,wn,{configurable:!0,value:t})},_n=At("species"),kn=function(e){var t=D[e];L&&t&&!t[_n]&&B.f(t,_n,{configurable:!0,get:function(){return this
}})},En=At("iterator"),Sn=!1;try{var Pn=[7][En]();Pn.return=function(){Sn=!0},Array.from(Pn,function(){throw 2})}catch(e){}var In,An,Cn,Dn,Tn=sn.set,On=function(){var e,t,n,r=function(){var r,i;for(hn&&(r=dn.domain)&&r.exit();e;){i=e.fn,e=e.next;try{i()}catch(r){throw e?n():t=void 0,r}}t=void 0,r&&r.enter()};if(hn)n=function(){dn.nextTick(r)};else if(!fn||D.navigator&&D.navigator.standalone)if(pn&&pn.resolve){var i=pn.resolve(void 0);n=function(){i.then(r)}}else n=function(){ln.call(D,r)};else{var o=!0,a=document.createTextNode("");
new fn(r).observe(a,{characterData:!0}),n=function(){a.data=o=!o}}return function(r){var i={fn:r,next:void 0};t&&(t.next=i),e||(e=i,n()),t=i}}(),jn="Promise",Nn=D.TypeError,Ln=D.process,Rn=Ln&&Ln.versions,qn=Rn&&Rn.v8||"",zn=D.Promise,Mn="process"==Rt(Ln),Wn=function(){},Fn=An=gn.f,Bn=!!function(){try{var e=zn.resolve(1),t=(e.constructor={})[At("species")]=function(e){e(Wn,Wn)};return(Mn||"function"==typeof PromiseRejectionEvent)&&e.then(Wn)instanceof t&&0!==qn.indexOf("6.6")&&-1===yn.indexOf("Chrome/66")
}catch(e){}}(),$n=function(e){var t;return!(!O(e)||"function"!=typeof(t=e.then))&&t},Gn=function(e,t){if(!e._n){e._n=!0;var n=e._c;On(function(){for(var r=e._v,i=1==e._s,o=0,a=function(e){var t,n,o,a=i?e.ok:e.fail,u=e.resolve,c=e.reject,s=e.domain;try{a?(i||(2==l._h&&Un(l),l._h=1),!0===a?t=r:(s&&s.enter(),t=a(r),s&&(s.exit(),o=!0)),t===e.promise?c(Nn("Promise-chain cycle")):(n=$n(t))?n.call(t,u,c):u(t)):c(r)}catch(l){s&&!o&&s.exit(),c(l)}};n.length>o;)a(n[o++]);e._c=[],e._n=!1,t&&!e._h&&Hn(e)})}},Hn=function(e){Tn.call(D,function(){var t,n,r,i=e._v,o=Vn(e);
if(o&&(t=mn(function(){Mn?Ln.emit("unhandledRejection",i,e):(n=D.onunhandledrejection)?n({promise:e,reason:i}):(r=D.console)&&r.error&&r.error("Unhandled promise rejection",i)}),e._h=Mn||Vn(e)?2:1),e._a=void 0,o&&t.e)throw t.v})},Vn=function(e){return 1!==e._h&&0===(e._a||e._c).length},Un=function(e){Tn.call(D,function(){var t;Mn?Ln.emit("rejectionHandled",e):(t=D.onrejectionhandled)&&t({promise:e,reason:e._v})})},Jn=function(e){var t=this;t._d||(t._d=!0,(t=t._w||t)._v=e,t._s=2,t._a||(t._a=t._c.slice()),Gn(t,!0))
},Kn=function(e){var t,n=this;if(!n._d){n._d=!0,n=n._w||n;try{if(n===e)throw Nn("Promise can't be resolved itself");(t=$n(e))?On(function(){var e={_w:n,_d:!1};try{t.call(r,et(Kn,e,1),et(Jn,e,1))}catch(r){Jn.call(e,r)}}):(n._v=e,n._s=1,Gn(n,!1))}catch(e){Jn.call({_w:n,_d:!1},e)}}};Bn||(zn=function(e){!function(e,t,n,r){if(!(e instanceof t)||void 0!==r&&r in e)throw TypeError(n+": incorrect invocation!")}(this,zn,jn,"_h"),Z(e),In.call(this);try{e(et(Kn,this,1),et(Jn,this,1))}catch(e){Jn.call(this,e)
}},(In=function(){this._c=[],this._a=void 0,this._s=0,this._d=!1,this._v=void 0,this._h=0,this._n=!1}).prototype=function(e,t,n){for(var r in t)Y(e,r,t[r],n);return e}(zn.prototype,{then:function(e,t){var n=Fn(Kt(this,zn));return n.ok="function"!=typeof e||e,n.fail="function"==typeof t&&t,n.domain=Mn?Ln.domain:void 0,this._c.push(n),this._a&&this._a.push(n),this._s&&Gn(this,!1),n.promise},"catch":function(e){return this.then(void 0,e)}}),Cn=function(){var e=new In;this.promise=e,this.resolve=et(Kn,e,1),this.reject=et(Jn,e,1)
},gn.f=Fn=function(e){return e===zn||e===Dn?new Cn(e):An(e)}),nt(nt.G+nt.W+nt.F*!Bn,{Promise:zn}),xn(zn,jn),kn(jn),Dn=T.Promise,nt(nt.S+nt.F*!Bn,jn,{reject:function(e){var t=Fn(this);return t.reject(e),t.promise}}),nt(nt.S+nt.F*!Bn,jn,{resolve:function(e){return function(e,t){if(j(e),O(t)&&t.constructor===e)return t;var n=gn.f(e);return n.resolve(t),n.promise}(this,e)}}),nt(nt.S+nt.F*!(Bn&&function(e,t){if(!t&&!Sn)return!1;var n=!1;try{var r=[7],i=r[En]();i.next=function(){return{done:n=!0}},r[En]=function(){return i
},e(r)}catch(e){}return n}(function(e){zn.all(e).catch(Wn)})),jn,{all:function(e){var t=this,n=Fn(t),r=n.resolve,i=n.reject,o=mn(function(){var n=[],o=0,a=1;Ut(e,!1,function(e){var u=o++,c=!1;n.push(void 0),a++,t.resolve(e).then(function(e){c||(c=!0,n[u]=e,--a||r(n))},i)}),--a||r(n)});return o.e&&i(o.v),n.promise},race:function(e){var t=this,n=Fn(t),r=n.reject,i=mn(function(){Ut(e,!1,function(e){t.resolve(e).then(n.resolve,r)})});return i.e&&r(i.v),n.promise}});var Xn=function(){function e(t){i(this,e),this.maxReconnect=3,this.curReconnect=0,this.openData={},this.config=t.websocket,this.ws=null,this.lockReconnect=!1,this.reTimeId,this.openCallback=null,this.closeCallback=null,this.resolveAuto=null,this.heartCheck={timeout:this.config.heartInterval,timeoutId:null,serverTimeoutId:null,current:this,start:function(){var e=this;
this.timeoutId&&clearTimeout(this.timeoutId),this.serverTimeoutId&&clearTimeout(this.serverTimeoutId),this.timeoutId=setTimeout(function(){1===e.current.ws.readyState&&e.current.ws.send("heartCheck"),e.serverTimeoutId=setTimeout(function(){e.current.ws.close()},e.timeout)},this.timeout)}}}return a(e,[{key:"reconnect",value:function(){var e=this;this.lockReconnect||this.curReconnect>=this.maxReconnect||(this.curReconnect++,this.closeCallback&&this.closeCallback(),this.lockReconnect=!0,this.reTimeId&&clearTimeout(this.reTimeId),this.reTimeId=setTimeout(function(){e.initWebsocket(e.openData),e.lockReconnect=!1
},this.config.reconnectInterval))}},{key:"initWebsocket",value:function(e,t,n,r,i){var o=this;this.openData=e,t&&(this.openCallback=t),n&&(this.closeCallback=n),r&&(this.resolveAuto=r);var a=this.config.url;this.ws=new WebSocket(a),this.ws.onerror=function(){o.closeCallback(),i&&console.warn("websocket服务出错了"),o.reconnect()},this.ws.onclose=function(){o.closeCallback(),i&&console.warn("websocket服务关闭了"),o.reconnect()},this.ws.onopen=function(){o.openCallback(),o.logWsConfig(e,i),o.heartCheck.start()
},this.ws.onmessage=function(e){o.heartCheck.start();var t=e.data&&JSON.parse(e.data).data;t&&t.length>0&&o.resolveAuto(t)}}},{key:"logWebsocket",value:function(e,t){this.ws&&1===this.ws.readyState?this.ws.send(e):t&&console.warn("ws未连接，无法发送数据")}},{key:"logWsConfig",value:function(e,t){this.logWebsocket(e,t)}}]),e}(),Qn=At("unscopables"),Yn=Array.prototype;null==Yn[Qn]&&G(Yn,Qn,{});var Zn=function(e){Yn[Qn][e]=!0},er=function(e,t){return{value:t,done:!!e}},tr=X("keys"),nr=function(e){return tr[e]||(tr[e]=K(e))
},rr=xt(!1),ir=nr("IE_PROTO"),or=function(e,t){var n,r=dt(e),i=0,o=[];for(n in r)n!=ir&&V(r,n)&&o.push(n);for(;t.length>i;)V(r,n=t[i++])&&(~rr(o,n)||o.push(n));return o},ar="constructor,hasOwnProperty,isPrototypeOf,propertyIsEnumerable,toLocaleString,toString,valueOf".split(","),ur=Object.keys||function(e){return or(e,ar)},cr=L?Object.defineProperties:function(e,t){j(e);for(var n,r=ur(t),i=r.length,o=0;i>o;)B.f(e,n=r[o++],t[n]);return e},sr=nr("IE_PROTO"),lr=function(){},fr=function(){var e,t=z("iframe"),n=ar.length;
for(t.style.display="none",Qt.appendChild(t),t.src="javascript:",(e=t.contentWindow.document).open(),e.write("<script>document.F=Object</script>"),e.close(),fr=e.F;n--;)delete fr.prototype[ar[n]];return fr()},dr=Object.create||function(e,t){var n;return null!==e?(lr.prototype=j(e),n=new lr,lr.prototype=null,n[sr]=e):n=fr(),void 0===t?n:cr(n,t)},pr={};G(pr,At("iterator"),function(){return this});var hr=function(e,t,n){e.prototype=dr(pr,{next:$(1,n)}),xn(e,t+" Iterator")},gr=nr("IE_PROTO"),mr=Object.prototype,vr=Object.getPrototypeOf||function(e){return e=It(e),V(e,gr)?e[gr]:"function"==typeof e.constructor&&e instanceof e.constructor?e.constructor.prototype:e instanceof Object?mr:null
},yr=At("iterator"),br=!([].keys&&"next"in[].keys()),wr="keys",xr="values",_r=function(){return this},kr=function(e,t,n,r,i,o,a){hr(n,t,r);var u,c,s,l=function(e){if(!br&&e in h)return h[e];switch(e){case wr:case xr:return function(){return new n(this,e)}}return function(){return new n(this,e)}},f=t+" Iterator",d=i==xr,p=!1,h=e.prototype,g=h[yr]||h["@@iterator"]||i&&h[i],m=g||l(i),v=i?d?l("entries"):m:void 0,y="Array"==t&&h.entries||g;if(y&&(s=vr(y.call(new e)))!==Object.prototype&&s.next&&(xn(s,f,!0),"function"!=typeof s[yr]&&G(s,yr,_r)),d&&g&&g.name!==xr&&(p=!0,m=function(){return g.call(this)
}),(br||p||!h[yr])&&G(h,yr,m),Bt[t]=m,Bt[f]=_r,i)if(u={values:d?m:l(xr),keys:o?m:l(wr),entries:v},a)for(c in u)c in h||Y(h,c,u[c]);else nt(nt.P+nt.F*(br||p),t,u);return u}(Array,"Array",function(e,t){this._t=dt(e),this._i=0,this._k=t},function(){var e=this._t,t=this._k,n=this._i++;return!e||n>=e.length?(this._t=void 0,er(1)):er(0,"keys"==t?n:"values"==t?e[n]:[n,e[n]])},"values");Bt.Arguments=Bt.Array,Zn("keys"),Zn("values"),Zn("entries");for(var Er=At("iterator"),Sr=At("toStringTag"),Pr=Bt.Array,Ir={CSSRuleList:!0,CSSStyleDeclaration:!1,CSSValueList:!1,ClientRectList:!1,DOMRectList:!1,DOMStringList:!1,DOMTokenList:!0,DataTransferItemList:!1,FileList:!1,HTMLAllCollection:!1,HTMLCollection:!1,HTMLFormElement:!1,HTMLSelectElement:!1,MediaList:!0,MimeTypeArray:!1,NamedNodeMap:!1,NodeList:!0,PaintRequestList:!1,Plugin:!1,PluginArray:!1,SVGLengthList:!1,SVGNumberList:!1,SVGPathSegList:!1,SVGPointList:!1,SVGStringList:!1,SVGTransformList:!1,SourceBufferList:!1,StyleSheetList:!0,TextTrackCueList:!1,TextTrackList:!1,TouchList:!1},Ar=ur(Ir),Cr=0;Cr<Ar.length;Cr++){var Dr,Tr=Ar[Cr],Or=Ir[Tr],jr=D[Tr],Nr=jr&&jr.prototype;
if(Nr&&(Nr[Er]||G(Nr,Er,Pr),Nr[Sr]||G(Nr,Sr,Tr),Bt[Tr]=Pr,Or))for(Dr in kr)Nr[Dr]||Y(Nr,Dr,kr[Dr],!0)}var Lr=["appname","timestamp","sv","av","trace","sample","page_id"],Rr=function(){function e(){i(this,e),this.baseParam={sv:"v1.0.1",av:"1.0.0"}}return a(e,[{key:"getBaseParam",value:function(){return this.baseParam}},{key:"setBaseParam",value:function(e,t){if(p(e))for(var n in e)Lr.indexOf(n)>-1&&(this.baseParam[n]=e[n]);else t&&console.warn("设置基础字段参数不是object")}}]),e}(),qr=At("match"),zr=function(e){var t;
return O(e)&&(void 0!==(t=e[qr])?!!t:"RegExp"==st(e))},Mr=function(e){return function(t,n){var r,i,o=String(ft(t)),a=gt(n),u=o.length;return 0>a||a>=u?e?"":void 0:(r=o.charCodeAt(a))<55296||r>56319||a+1===u||(i=o.charCodeAt(a+1))<56320||i>57343?e?o.charAt(a):r:e?o.slice(a,a+2):i-56320+(r-55296<<10)+65536}}(!0),Wr=function(e,t,n){return t+(n?Mr(e,t).length:1)},Fr=RegExp.prototype.exec,Br=function(e,t){var n=e.exec;if("function"==typeof n){var r=n.call(e,t);if("object"!=typeof r)throw new TypeError("RegExp exec method returned something other than an Object or null");
return r}if("RegExp"!==Rt(e))throw new TypeError("RegExp#exec called on incompatible receiver");return Fr.call(e,t)},$r=function(){var e=j(this),t="";return e.global&&(t+="g"),e.ignoreCase&&(t+="i"),e.multiline&&(t+="m"),e.unicode&&(t+="u"),e.sticky&&(t+="y"),t},Gr=RegExp.prototype.exec,Hr=String.prototype.replace,Vr=Gr,Ur=function(){var e=/a/,t=/b*/g;return Gr.call(e,"a"),Gr.call(t,"a"),0!==e.lastIndex||0!==t.lastIndex}(),Jr=void 0!==/()??/.exec("")[1];(Ur||Jr)&&(Vr=function(e){var t,n,r,i,o=this;
return Jr&&(n=new RegExp("^"+o.source+"$(?!\\s)",$r.call(o))),Ur&&(t=o.lastIndex),r=Gr.call(o,e),Ur&&r&&(o.lastIndex=o.global?r.index+r[0].length:t),Jr&&r&&r.length>1&&Hr.call(r[0],n,function(){for(i=1;i<arguments.length-2;i++)void 0===arguments[i]&&(r[i]=void 0)}),r});var Kr=Vr;nt({target:"RegExp",proto:!0,forced:Kr!==/./.exec},{exec:Kr});var Xr=At("species"),Qr=!N(function(){var e=/./;return e.exec=function(){var e=[];return e.groups={a:"7"},e},"7"!=="".replace(e,"$<a>")}),Yr=function(){var e=/(?:)/,t=e.exec;
e.exec=function(){return t.apply(this,arguments)};var n="ab".split(e);return 2===n.length&&"a"===n[0]&&"b"===n[1]}(),Zr=function(e,t,n){var r=At(e),i=!N(function(){var t={};return t[r]=function(){return 7},7!=""[e](t)}),o=i?!N(function(){var t=!1,n=/a/;return n.exec=function(){return t=!0,null},"split"===e&&(n.constructor={},n.constructor[Xr]=function(){return n}),n[r](""),!t}):void 0;if(!i||!o||"replace"===e&&!Qr||"split"===e&&!Yr){var a=/./[r],u=n(ft,r,""[e],function(e,t,n,r,o){return t.exec===Kr?i&&!o?{done:!0,value:a.call(t,n,r)}:{done:!0,value:e.call(n,t,r)}:{done:!1}
}),c=u[0],s=u[1];Y(String.prototype,e,c),G(RegExp.prototype,r,2==t?function(e,t){return s.call(e,this,t)}:function(e){return s.call(e,this)})}},ei=Math.min,ti=[].push,ni=4294967295,ri=!N(function(){RegExp(ni,"y")});Zr("split",2,function(e,t,n,r){var i;return i="c"=="abbc".split(/(b)*/)[1]||4!="test".split(/(?:)/,-1).length||2!="ab".split(/(?:ab)*/).length||4!=".".split(/(.?)(.?)/).length||".".split(/()()/).length>1||"".split(/.?/).length?function(e,t){var r=String(this);if(void 0===e&&0===t)return[];
if(!zr(e))return n.call(r,e,t);for(var i,o,a,u=[],c=(e.ignoreCase?"i":"")+(e.multiline?"m":"")+(e.unicode?"u":"")+(e.sticky?"y":""),s=0,l=void 0===t?ni:t>>>0,f=new RegExp(e.source,c+"g");(i=Kr.call(f,r))&&!((o=f.lastIndex)>s&&(u.push(r.slice(s,i.index)),i.length>1&&i.index<r.length&&ti.apply(u,i.slice(1)),a=i[0].length,s=o,u.length>=l));)f.lastIndex===i.index&&f.lastIndex++;return s===r.length?!a&&f.test("")||u.push(""):u.push(r.slice(s)),u.length>l?u.slice(0,l):u}:"0".split(void 0,0).length?function(e,t){return void 0===e&&0===t?[]:n.call(this,e,t)
}:n,[function(n,r){var o=e(this),a=null==n?void 0:n[t];return void 0!==a?a.call(n,o,r):i.call(String(o),n,r)},function(e,t){var o=r(i,e,this,t,i!==n);if(o.done)return o.value;var a=j(e),u=String(this),c=Kt(a,RegExp),s=a.unicode,l=(a.ignoreCase?"i":"")+(a.multiline?"m":"")+(a.unicode?"u":"")+(ri?"y":"g"),f=new c(ri?a:"^(?:"+a.source+")",l),d=void 0===t?ni:t>>>0;if(0===d)return[];if(0===u.length)return null===Br(f,u)?[u]:[];for(var p=0,h=0,g=[];h<u.length;){f.lastIndex=ri?h:0;var m,v=Br(f,ri?u:u.slice(h));
if(null===v||(m=ei(vt(f.lastIndex+(ri?0:h)),u.length))===p)h=Wr(u,h,s);else{if(g.push(u.slice(p,h)),g.length===d)return g;for(var y=1;y<=v.length-1;y++)if(g.push(v[y]),g.length===d)return g;h=p=m}}return g.push(u.slice(p)),g}]});var ii={f:{}.propertyIsEnumerable},oi=Object.getOwnPropertyDescriptor,ai={f:L?oi:function(e,t){if(e=dt(e),t=W(t,!0),M)try{return oi(e,t)}catch(e){}return V(e,t)?$(!ii.f.call(e,t),e[t]):void 0}},ui=function(e,t){if(j(e),!O(t)&&null!==t)throw TypeError(t+": can't set as prototype!")
},ci={set:Object.setPrototypeOf||("__proto__"in{}?function(e,t,n){try{(n=et(Function.call,ai.f(Object.prototype,"__proto__").set,2))(e,[]),t=!(e instanceof Array)}catch(e){t=!0}return function(e,r){return ui(e,r),t?e.__proto__=r:n(e,r),e}}({},!1):void 0),check:ui},si=ci.set,li=ar.concat("length","prototype"),fi={f:Object.getOwnPropertyNames||function(e){return or(e,li)}},di=B.f,pi=fi.f,hi=D.RegExp,gi=hi,mi=hi.prototype,vi=/a/g,yi=/a/g,bi=new hi(vi)!==vi;if(L&&(!bi||N(function(){return yi[At("match")]=!1,hi(vi)!=vi||hi(yi)==yi||"/a/i"!=hi(vi,"i")
}))){hi=function(e,t){var n,r,i,o,a=this instanceof hi,u=zr(e),c=void 0===t;return!a&&u&&e.constructor===hi&&c?e:(n=bi?new gi(u&&!c?e.source:e,t):gi((u=e instanceof hi)?e.source:e,u&&c?$r.call(e):t),r=hi,(o=(a?this:mi).constructor)!==r&&"function"==typeof o&&(i=o.prototype)!==r.prototype&&O(i)&&si&&si(n,i),n)};for(var wi=(function(e){e in hi||di(hi,e,{configurable:!0,get:function(){return gi[e]},set:function(t){gi[e]=t}})}),xi=pi(gi),_i=0;xi.length>_i;)wi(xi[_i++]);mi.constructor=hi,hi.prototype=mi,Y(D,"RegExp",hi)
}kn("RegExp"),Zr("match",1,function(e,t,n,r){return[function(n){var r=e(this),i=null==n?void 0:n[t];return void 0!==i?i.call(n,r):new RegExp(n)[t](String(r))},function(e){var t=r(n,e,this);if(t.done)return t.value;var i=j(e),o=String(this);if(!i.global)return Br(i,o);var a=i.unicode;i.lastIndex=0;for(var u,c=[],s=0;null!==(u=Br(i,o));){var l=String(u[0]);c[s]=l,""===l&&(i.lastIndex=Wr(o,vt(i.lastIndex),a)),s++}return 0===s?null:c}]});var ki=Date.prototype,Ei="Invalid Date",Si="toString",Pi=ki.toString,Ii=ki.getTime;
new Date(0/0)+""!=Ei&&Y(ki,Si,function(){var e=Ii.call(this);return e==e?Pi.call(this):Ei}),L&&"g"!=/./g.flags&&B.f(RegExp.prototype,"flags",{configurable:!0,get:$r});var Ai="toString",Ci=/./.toString,Di=function(e){Y(RegExp.prototype,Ai,e,!0)};N(function(){return"/a/b"!=Ci.call({source:"a",flags:"b"})})?Di(function(){var e=j(this);return"/".concat(e.source,"/","flags"in e?e.flags:!L&&e instanceof RegExp?$r.call(e):void 0)}):Ci.name!=Ai&&Di(function(){return Ci.call(this)});var Ti={"www.baidu.com":"baidusearch","m.baidu.com":"baidusearch","m5.baidu.com":"baidusearch","www.baike.com":"toutiaobaike","baike.so.com":"360baike","m.baike.so.com":"360baike","zh.wikipedia.org":"wikipedia","zh.m.wikipedia.org":"wikipedia","baike.soso.com":"sogoubaike","baike.wap.soso.com":"sogoubaike","m.sm.cn":"shenma","so.m.sm.cn":"shenma","wap.sogou.com":"sougou","m.sogou.com":"sougou","www.sogou.com":"sougou","www.so.com":"360search","m.so.com":"360search","www.bing.com":"bing","cn.bing.com":"bing","yandex.com":"yandex","www.soso.com":"soso","haokan.baidu.com":"baidu-haokan","tieba.baidu.com":"baidu-tieba","image.baidu.com":"baidu-image","wk.baidu.com":"wenku","wapwenku.baidu.com":"wenku","wenku.baidu.com":"wenku","jingyan.baidu.com":"jingyan","zhidao.baidu.com":"zhidao","power.baidu.com":"zhidao","zhidaocommit.baidu.cn":"zhidao","zhidao.baidu.cn":"zhidao","z.baidu.com":"zhidao","wapiknow.baidu.com":"zhidao","wapiknow.baidu.cn":"zhidao","app.wapiknow.baidu.com":"zhidao","baobao.baidu.com":"bbzd","hanyu.baidu.com":"hanyu","haoxue.baidu.com":"haoxue","youjia.baidu.com":"youjia","expert.baidu.com":"expert","shushuo.baidu.com":"shushuo","www.iqiyi.com":"iqiyi","m.iqiyi.com":"iqiyi","wenda.so.com":"360wenda","m.wenda.so.com":"360wenda","iask.sina.com.cn":"iasksina","www.haodf.com":"haodf","m.haodf.com":"haodf","wenda.tianya.cn":"tianyawenda","www.zhihu.com":"zhihu","m.zhihu.com":"zhihu","wenda.sohu.com":"sohuwenda","wenda.sogou.com":"sohuwenda","wenwen.sogou.com":"sogouwenwen","wenwen.m.sogou.com":"sogouwenwen","muzhi.baidu.com":"muzhibaidu","www.39.net":"39jiankang","m.39.net":"39jiankang","www.xywy.com":"xywy","club.xywy.com":"xywy","3g.xywy.com":"xywy","3g.club.xywy.com":"xywy","www.120ask.com":"120ask","m.120ask.com":"120ask","www.chunyuyisheng.com":"chunyuyisheng","www.wenbing.cn":"wenbing","www.qiuyi.cn":"qiuyi","www.fh21.com.cn":"fh21","wap.fh21.com.cn":"fh21","www.qqyy.com":"qqyy","www.myzx.cn":"myzx","m.myzx.cn":"myzx","www.99.com.cn":"99jiankang","m.99.com.cn":"99jiankang","www.babytree.com":"babytree","m.babytree.com":"babytree","3g.babytree.com":"babytree","www.pcbaby.com.cn":"pcbaby","m.pcbaby.com.cn":"pcbaby","www.ci123.com":"ci123","www.mama.cn":"mama","www.yaolan.com":"yaolan","3g.yaolan.com":"yaolan","beijing.iyaya.com":"iyaya","www.iyaya.com":"iyaya","zuoye.baidu.com":"zuoyebang","homework.baidu.com":"zuoyebang","www.zuoyebang.com":"zuoyebang","www.zybang.com":"zuoyebang","www.jyeoo.com":"jyeoo","shop.jyeoo.com":"jyeoo","m.jyeoo.com":"jyeoo","www.mofangge.com":"mofangge","user.mofangge.com":"mofangge","zuowen.mofangge.com":"mofangge","zuoye.mofangge.com":"mofangge","bxt.mofangge.com":"mofangge","17.mofangge.com":"mofangge","zone.mofangge.com":"mofangge","m.mofangge.com":"mofangge"},Oi=[{domain:"google.co",channel:"google"},{domain:"yahoo.co",channel:"yahoo"}],ji={web:["url","referer","ua","baiduid","device","sid","cuid","uk","network","channel","fr","visitId"],xcx:["device","swan_id","app_version","app_key","scene","baiduid","session_id","cuid","uk","sid","network","os_version","host_app","host_version","sdk_version","url","referer","screen","device_mfr","device_md","channel","fr","visitId"]},Ni=function(){function e(){i(this,e),this.platform="web",this.platParam={}
}return a(e,[{key:"setInitPlatParam",value:function(e,t){var n=this;this.platParam.url=window.location.href,this.platParam.referer=document.referrer,this.platParam.ua=navigator.userAgent,document.cookie&&document.cookie.split("; ").forEach(function(t){var r=t.split("=");"BAIDUID"===r[0]?n.platParam.baiduid=r[1]:"pc"===e&&"H_PS_PSSID"===r[0]||"h5"===e&&"H_WISE_SIDS"===r[0]?n.platParam.sid=r[1]:"BAIDUCUID"===r[0]&&(n.platParam.cuid=r[1])}),this.platParam.channel=v(document.referrer),t&&(this.platParam.visitId=function(e){var t=e&&e.split("/")[2];
if(t&&t.indexOf("baike.baidu")>-1||t.indexOf("baike.otp.baidu")>-1)return y("baikeVisitId");var n=g();return b("baikeVisitId",n),n}(document.referrer)),m(this.platParam.url,"fr")&&(this.platParam.fr=m(this.platParam.url,"fr"))}},{key:"getPlatform",value:function(){return this.platform}},{key:"getPlatParam",value:function(){return this.platParam}},{key:"setPlatParam",value:function(e,t,n){if(""!==this.platform)if(p(e)){var r=void 0!==e.setVisitId?e.setVisitId:n;for(var i in this.setInitPlatParam(e.device,r),e)ji[this.platform].indexOf(i)>-1&&(this.platParam[i]=e[i])
}else t&&console.warn("设置平台字段参数不是object");else t&&console.warn("设置平台字段参数之前，请先设置平台。")}}]),e}(),Li={viewPage:{"default":{atype:"view",stype:"page"},required:["page"],keys:["page","page_param","series","ignore","has_video"]},viewEl:{"default":{atype:"view",stype:"element"},required:["page"],keys:["page","page_param","element","element_param","element_type","element_id","position_top","position_left","list","list_param","index","list2","list2_param","list2_index","list3","list3_param","list3_index","series","is_video","video_id"],ename:"element"},viewElDraw:{"default":{atype:"view",stype:"element-draw"},required:["page"],keys:["page","page_param","element","element_param","element_type","element_id","position_top","position_left","list","list_param","index","list2","list2_param","list2_index","list3","list3_param","list3_index","series","is_video","video_id"],ename:"element"},actClick:{"default":{atype:"act",stype:"click"},required:["page"],keys:["page","page_param","element","element_param","element_type","element_id","position_top","position_left","list","list_param","index","list2","list2_param","list2_index","list3","list3_param","list3_index","series","nav","nav_target","clk_type","times"],ename:"element"},actVideo:{"default":{atype:"act",stype:"video"},required:["video_action"],keys:["page","page_param","video_name","video_id","video_param","video_action","video_position","duration","video_position_p","play_times","series"],ename:"video_action"},actScroll:{"default":{atype:"act",stype:"scroll"},required:["page"],keys:["page","page_param","scroll_top","scroll_left","scroll_top_p","scroll_left_p","page_height","page_width","scroll_top_max","scroll_left_max","scroll_top_max_p","scroll_left_max_p","direction","series"]},actEvent:{"default":{atype:"act",stype:"event"},required:["act_type"],keys:["page","page_param","element","element_param","act_type","act_param","series"],ename:"act_type"},timingPage:{"default":{atype:"timing",stype:"page"},required:["page_id","page","time_duration"],keys:["page_id","page","page_param","time_duration","time_all","time_piece","tick"]},timingVideo:{"default":{atype:"timing",stype:"video"},required:["time_duration"],keys:["page","page_param","video_name","video_id","video_param","video_position","duration","video_position_p","play_times","time_duration","time_single","time_piece","tick"]},timingOthers:{"default":{atype:"timing",stype:"others"},required:["page","timing_type","time_duration"],keys:["page","timing_type","time_duration","position"],ename:"timing_type"},eventError:{"default":{atype:"event",stype:"error"},required:[],keys:["page","page_param","event_level","event_file","event_line","event_msg"]}},Ri=function(){function e(){i(this,e),this.globalParam={debug:!1,http:{url:"https://cstm.baidu.com/log/common/v.gif"},websocket:{url:"wss://cstm.baidu.com/log/index",reconnectInterval:2e3,heartInterval:3e3,binaryType:"blob"}}
}return a(e,[{key:"getGlobalParam",value:function(){return this.globalParam}},{key:"setGlobalParam",value:function(e,t){if(p(e)){for(var n in e)if(void 0!==this.globalParam[n])if(p(this.globalParam[n])&&p(e[n]))for(var r in e[n])this.globalParam[n][r]?this.globalParam[n][r]=e[n][r]:t&&console.warn("设置全局参数中，"+n+"中的"+r+"不是全局参数");else this.globalParam[n]=e[n]}else t&&console.warn("设置全局参数不是object")}}]),e}(),qi=[].slice;nt(nt.P+nt.F*N(function(){Qt&&qi.call(Qt)}),"Array",{slice:function(e,t){var n=vt(this.length),r=st(this);
if(t=void 0===t?n:t,"Array"==r)return qi.call(this,e,t);for(var i=wt(e,n),o=wt(t,n),a=vt(o-i),u=new Array(a),c=0;a>c;c++)u[c]="String"==r?this.charAt(i+c):this[i+c];return u}});var zi=Math.max,Mi=Math.min,Wi=Math.floor,Fi=/\$([$&`']|\d\d?|<[^>]*>)/g,Bi=/\$([$&`']|\d\d?)/g;Zr("replace",2,function(e,t,n,r){function i(e,t,r,i,o,a){var u=r+e.length,c=i.length,s=Bi;return void 0!==o&&(o=It(o),s=Fi),n.call(a,s,function(n,a){var s;switch(a.charAt(0)){case"$":return"$";case"&":return e;case"`":return t.slice(0,r);
case"'":return t.slice(u);case"<":s=o[a.slice(1,-1)];break;default:var l=+a;if(0===l)return n;if(l>c){var f=Wi(l/10);return 0===f?n:c>=f?void 0===i[f-1]?a.charAt(1):i[f-1]+a.charAt(1):n}s=i[l-1]}return void 0===s?"":s})}return[function(r,i){var o=e(this),a=null==r?void 0:r[t];return void 0!==a?a.call(r,o,i):n.call(String(o),r,i)},function(e,t){var o=r(n,e,this,t);if(o.done)return o.value;var a=j(e),u=String(this),c="function"==typeof t;c||(t=String(t));var s=a.global;if(s){var l=a.unicode;a.lastIndex=0
}for(var f=[];;){var d=Br(a,u);if(null===d)break;if(f.push(d),!s)break;""===String(d[0])&&(a.lastIndex=Wr(u,vt(a.lastIndex),l))}for(var p,h="",g=0,m=0;m<f.length;m++){d=f[m];for(var v=String(d[0]),y=zi(Mi(gt(d.index),u.length),0),b=[],w=1;w<d.length;w++)b.push(void 0===(p=d[w])?p:String(p));var x=d.groups;if(c){var _=[v].concat(b,y,u);void 0!==x&&_.push(x);var k=String(t.apply(void 0,_))}else k=i(v,u,y,b,x,t);y>=g&&(h+=u.slice(g,y)+k,g=y+v.length)}return h+u.slice(g)}]});var $i=Tt(2);nt(nt.P+nt.F*!_t([].filter,!0),"Array",{filter:function(e){return $i(this,e,arguments[1])
}});var Gi=Tt(5),Hi="find",Vi=!0;Hi in[]&&Array(1).find(function(){Vi=!1}),nt(nt.P+nt.F*Vi,"Array",{find:function(e){return Gi(this,e,arguments.length>1?arguments[1]:void 0)}}),Zn(Hi);var Ui=[].sort,Ji=[1,2,3];nt(nt.P+nt.F*(N(function(){Ji.sort(void 0)})||!N(function(){Ji.sort(null)})||!_t(Ui)),"Array",{sort:function(e){return void 0===e?Ui.call(It(this)):Ui.call(It(this),Z(e))}});var Ki=c(function(e){!function(t){function n(e,t,n,r){var i,o,a,u,c,s,f,p=t&&t.ownerDocument,h=t?t.nodeType:9;if(n=n||[],"string"!=typeof e||!e||1!==h&&9!==h&&11!==h)return n;
if(!r&&(D(t),t=t||T,j)){if(11!==h&&(c=vt.exec(e)))if(i=c[1]){if(9===h){if(!(a=t.getElementById(i)))return n;if(a.id===i)return n.push(a),n}else if(p&&(a=p.getElementById(i))&&q(t,a)&&a.id===i)return n.push(a),n}else{if(c[2])return Q.apply(n,t.getElementsByTagName(e)),n;if((i=c[3])&&w.getElementsByClassName&&t.getElementsByClassName)return Q.apply(n,t.getElementsByClassName(i)),n}if(!(!w.qsa||H[e+" "]||N&&N.test(e)||1===h&&"object"===t.nodeName.toLowerCase())){if(f=e,p=t,1===h&&(st.test(e)||ct.test(e))){for((p=yt.test(e)&&l(t.parentNode)||t)===t&&w.scope||((u=t.getAttribute("id"))?u=u.replace(xt,_t):t.setAttribute("id",u=z)),o=(s=E(e)).length;o--;)s[o]=(u?"#"+u:":scope")+" "+d(s[o]);
f=s.join(",")}try{return Q.apply(n,p.querySelectorAll(f)),n}catch(t){H(e,!0)}finally{u===z&&t.removeAttribute("id")}}}return P(e.replace(at,"$1"),t,n,r)}function r(){var e=[];return function t(n,r){return e.push(n+" ")>x.cacheLength&&delete t[e.shift()],t[n+" "]=r}}function i(e){return e[z]=!0,e}function o(e){var t=T.createElement("fieldset");try{return!!e(t)}catch(e){return!1}finally{t.parentNode&&t.parentNode.removeChild(t),t=null}}function a(e,t){for(var n=e.split("|"),r=n.length;r--;)x.attrHandle[n[r]]=t
}function u(e,t){var n=t&&e,r=n&&1===e.nodeType&&1===t.nodeType&&e.sourceIndex-t.sourceIndex;if(r)return r;if(n)for(;n=n.nextSibling;)if(n===t)return-1;return e?1:-1}function c(e){return function(t){return"form"in t?t.parentNode&&!1===t.disabled?"label"in t?"label"in t.parentNode?t.parentNode.disabled===e:t.disabled===e:t.isDisabled===e||t.isDisabled!==!e&&Et(t)===e:t.disabled===e:"label"in t&&t.disabled===e}}function s(e){return i(function(t){return t=+t,i(function(n,r){for(var i,o=e([],n.length,t),a=o.length;a--;)n[i=o[a]]&&(n[i]=!(r[i]=n[i]))
})})}function l(e){return e&&void 0!==e.getElementsByTagName&&e}function f(){}function d(e){for(var t=0,n=e.length,r="";n>t;t++)r+=e[t].value;return r}function p(e,t,n){var r=t.dir,i=t.next,o=i||r,a=n&&"parentNode"===o,u=F++;return t.first?function(t,n,i){for(;t=t[r];)if(1===t.nodeType||a)return e(t,n,i);return!1}:function(t,n,c){var s,l,f,d=[W,u];if(c){for(;t=t[r];)if((1===t.nodeType||a)&&e(t,n,c))return!0}else for(;t=t[r];)if(1===t.nodeType||a)if(l=(f=t[z]||(t[z]={}))[t.uniqueID]||(f[t.uniqueID]={}),i&&i===t.nodeName.toLowerCase())t=t[r]||t;
else{if((s=l[o])&&s[0]===W&&s[1]===u)return d[2]=s[2];if(l[o]=d,d[2]=e(t,n,c))return!0}return!1}}function h(e){return e.length>1?function(t,n,r){for(var i=e.length;i--;)if(!e[i](t,n,r))return!1;return!0}:e[0]}function g(e,t,n,r,i){for(var o,a=[],u=0,c=e.length,s=null!=t;c>u;u++)(o=e[u])&&(n&&!n(o,r,i)||(a.push(o),s&&t.push(u)));return a}function m(e,t,r,o,a,u){return o&&!o[z]&&(o=m(o)),a&&!a[z]&&(a=m(a,u)),i(function(i,u,c,s){var l,f,d,p=[],h=[],m=u.length,v=i||function(e,t,r){for(var i=0,o=t.length;o>i;i++)n(e,t[i],r);
return r}(t||"*",c.nodeType?[c]:c,[]),y=!e||!i&&t?v:g(v,p,e,c,s),b=r?a||(i?e:m||o)?[]:u:y;if(r&&r(y,b,c,s),o)for(l=g(b,h),o(l,[],c,s),f=l.length;f--;)(d=l[f])&&(b[h[f]]=!(y[h[f]]=d));if(i){if(a||e){if(a){for(l=[],f=b.length;f--;)(d=b[f])&&l.push(y[f]=d);a(null,b=[],l,s)}for(f=b.length;f--;)(d=b[f])&&(l=a?Z(i,d):p[f])>-1&&(i[l]=!(u[l]=d))}}else b=g(b===u?b.splice(m,b.length):b),a?a(null,u,b,s):Q.apply(u,b)})}function v(e){for(var t,n,r,i=e.length,o=x.relative[e[0].type],a=o||x.relative[" "],u=o?1:0,c=p(function(e){return e===t
},a,!0),s=p(function(e){return Z(t,e)>-1},a,!0),l=[function(e,n,r){var i=!o&&(r||n!==I)||((t=n).nodeType?c(e,n,r):s(e,n,r));return t=null,i}];i>u;u++)if(n=x.relative[e[u].type])l=[p(h(l),n)];else{if((n=x.filter[e[u].type].apply(null,e[u].matches))[z]){for(r=++u;i>r&&!x.relative[e[r].type];r++);return m(u>1&&h(l),u>1&&d(e.slice(0,u-1).concat({value:" "===e[u-2].type?"*":""})).replace(at,"$1"),n,r>u&&v(e.slice(u,r)),i>r&&v(e=e.slice(r)),i>r&&d(e))}l.push(n)}return h(l)}function y(e,t){var r=t.length>0,o=e.length>0,a=function(i,a,u,c,s){var l,f,d,p=0,h="0",m=i&&[],v=[],y=I,b=i||o&&x.find.TAG("*",s),w=W+=null==y?1:Math.random()||.1,_=b.length;
for(s&&(I=a==T||a||s);h!==_&&null!=(l=b[h]);h++){if(o&&l){for(f=0,a||l.ownerDocument==T||(D(l),u=!j);d=e[f++];)if(d(l,a||T,u)){c.push(l);break}s&&(W=w)}r&&((l=!d&&l)&&p--,i&&m.push(l))}if(p+=h,r&&h!==p){for(f=0;d=t[f++];)d(m,v,a,u);if(i){if(p>0)for(;h--;)m[h]||v[h]||(v[h]=K.call(c));v=g(v)}Q.apply(c,v),s&&!i&&v.length>0&&p+t.length>1&&n.uniqueSort(c)}return s&&(W=w,I=y),m};return r?i(a):a}var b,w,x,_,k,E,S,P,I,A,C,D,T,O,j,N,L,R,q,z="sizzle"+1*new Date,M=t.document,W=0,F=0,B=r(),$=r(),G=r(),H=r(),V=function(e,t){return e===t&&(C=!0),0
},U={}.hasOwnProperty,J=[],K=J.pop,X=J.push,Q=J.push,Y=J.slice,Z=function(e,t){for(var n=0,r=e.length;r>n;n++)if(e[n]===t)return n;return-1},et="checked|selected|async|autofocus|autoplay|controls|defer|disabled|hidden|ismap|loop|multiple|open|readonly|required|scoped",tt="[\\x20\\t\\r\\n\\f]",nt="(?:\\\\[\\da-fA-F]{1,6}"+tt+"?|\\\\[^\\r\\n\\f]|[\\w-]|[^\x00-\\x7f])+",rt="\\["+tt+"*("+nt+")(?:"+tt+"*([*^$|!~]?=)"+tt+"*(?:'((?:\\\\.|[^\\\\'])*)'|\"((?:\\\\.|[^\\\\\"])*)\"|("+nt+"))|)"+tt+"*\\]",it=":("+nt+")(?:\\((('((?:\\\\.|[^\\\\'])*)'|\"((?:\\\\.|[^\\\\\"])*)\")|((?:\\\\.|[^\\\\()[\\]]|"+rt+")*)|.*)\\)|)",ot=new RegExp(tt+"+","g"),at=new RegExp("^"+tt+"+|((?:^|[^\\\\])(?:\\\\.)*)"+tt+"+$","g"),ut=new RegExp("^"+tt+"*,"+tt+"*"),ct=new RegExp("^"+tt+"*([>+~]|"+tt+")"+tt+"*"),st=new RegExp(tt+"|>"),lt=new RegExp(it),ft=new RegExp("^"+nt+"$"),dt={ID:new RegExp("^#("+nt+")"),CLASS:new RegExp("^\\.("+nt+")"),TAG:new RegExp("^("+nt+"|[*])"),ATTR:new RegExp("^"+rt),PSEUDO:new RegExp("^"+it),CHILD:new RegExp("^:(only|first|last|nth|nth-last)-(child|of-type)(?:\\("+tt+"*(even|odd|(([+-]|)(\\d*)n|)"+tt+"*(?:([+-]|)"+tt+"*(\\d+)|))"+tt+"*\\)|)","i"),bool:new RegExp("^(?:"+et+")$","i"),needsContext:new RegExp("^"+tt+"*[>+~]|:(even|odd|eq|gt|lt|nth|first|last)(?:\\("+tt+"*((?:-\\d)?\\d*)"+tt+"*\\)|)(?=[^-]|$)","i")},pt=/HTML$/i,ht=/^(?:input|select|textarea|button)$/i,gt=/^h\d$/i,mt=/^[^{]+\{\s*\[native \w/,vt=/^(?:#([\w-]+)|(\w+)|\.([\w-]+))$/,yt=/[+~]/,bt=new RegExp("\\\\[\\da-fA-F]{1,6}"+tt+"?|\\\\([^\\r\\n\\f])","g"),wt=function(e,t){var n="0x"+e.slice(1)-65536;
return t||(0>n?String.fromCharCode(n+65536):String.fromCharCode(n>>10|55296,1023&n|56320))},xt=/([\0-\x1f\x7f]|^-?\d)|^-$|[^\0-\x1f\x7f-\uFFFF\w-]/g,_t=function(e,t){return t?"\x00"===e?"�":e.slice(0,-1)+"\\"+e.charCodeAt(e.length-1).toString(16)+" ":"\\"+e},kt=function(){D()},Et=p(function(e){return!0===e.disabled&&"fieldset"===e.nodeName.toLowerCase()},{dir:"parentNode",next:"legend"});try{Q.apply(J=Y.call(M.childNodes),M.childNodes),J[M.childNodes.length].nodeType}catch(t){Q={apply:J.length?function(e,t){X.apply(e,Y.call(t))
}:function(e,t){for(var n=e.length,r=0;e[n++]=t[r++];);e.length=n-1}}}for(b in w=n.support={},k=n.isXML=function(e){var t=e.namespaceURI,n=(e.ownerDocument||e).documentElement;return!pt.test(t||n&&n.nodeName||"HTML")},D=n.setDocument=function(e){var t,n,r=e?e.ownerDocument||e:M;return r!=T&&9===r.nodeType&&r.documentElement?(O=(T=r).documentElement,j=!k(T),M!=T&&(n=T.defaultView)&&n.top!==n&&(n.addEventListener?n.addEventListener("unload",kt,!1):n.attachEvent&&n.attachEvent("onunload",kt)),w.scope=o(function(e){return O.appendChild(e).appendChild(T.createElement("div")),void 0!==e.querySelectorAll&&!e.querySelectorAll(":scope fieldset div").length
}),w.attributes=o(function(e){return e.className="i",!e.getAttribute("className")}),w.getElementsByTagName=o(function(e){return e.appendChild(T.createComment("")),!e.getElementsByTagName("*").length}),w.getElementsByClassName=mt.test(T.getElementsByClassName),w.getById=o(function(e){return O.appendChild(e).id=z,!T.getElementsByName||!T.getElementsByName(z).length}),w.getById?(x.filter.ID=function(e){var t=e.replace(bt,wt);return function(e){return e.getAttribute("id")===t}},x.find.ID=function(e,t){if(void 0!==t.getElementById&&j){var n=t.getElementById(e);
return n?[n]:[]}}):(x.filter.ID=function(e){var t=e.replace(bt,wt);return function(e){var n=void 0!==e.getAttributeNode&&e.getAttributeNode("id");return n&&n.value===t}},x.find.ID=function(e,t){if(void 0!==t.getElementById&&j){var n,r,i,o=t.getElementById(e);if(o){if((n=o.getAttributeNode("id"))&&n.value===e)return[o];for(i=t.getElementsByName(e),r=0;o=i[r++];)if((n=o.getAttributeNode("id"))&&n.value===e)return[o]}return[]}}),x.find.TAG=w.getElementsByTagName?function(e,t){return void 0!==t.getElementsByTagName?t.getElementsByTagName(e):w.qsa?t.querySelectorAll(e):void 0
}:function(e,t){var n,r=[],i=0,o=t.getElementsByTagName(e);if("*"===e){for(;n=o[i++];)1===n.nodeType&&r.push(n);return r}return o},x.find.CLASS=w.getElementsByClassName&&function(e,t){return void 0!==t.getElementsByClassName&&j?t.getElementsByClassName(e):void 0},L=[],N=[],(w.qsa=mt.test(T.querySelectorAll))&&(o(function(e){var t;O.appendChild(e).innerHTML="<a id='"+z+"'></a><select id='"+z+"-\r\\' msallowcapture=''><option selected=''></option></select>",e.querySelectorAll("[msallowcapture^='']").length&&N.push("[*^$]="+tt+"*(?:''|\"\")"),e.querySelectorAll("[selected]").length||N.push("\\["+tt+"*(?:value|"+et+")"),e.querySelectorAll("[id~="+z+"-]").length||N.push("~="),(t=T.createElement("input")).setAttribute("name",""),e.appendChild(t),e.querySelectorAll("[name='']").length||N.push("\\["+tt+"*name"+tt+"*="+tt+"*(?:''|\"\")"),e.querySelectorAll(":checked").length||N.push(":checked"),e.querySelectorAll("a#"+z+"+*").length||N.push(".#.+[+~]"),e.querySelectorAll("\\\f"),N.push("[\\r\\n\\f]")
}),o(function(e){e.innerHTML="<a href='' disabled='disabled'></a><select disabled='disabled'><option/></select>";var t=T.createElement("input");t.setAttribute("type","hidden"),e.appendChild(t).setAttribute("name","D"),e.querySelectorAll("[name=d]").length&&N.push("name"+tt+"*[*^$|!~]?="),2!==e.querySelectorAll(":enabled").length&&N.push(":enabled",":disabled"),O.appendChild(e).disabled=!0,2!==e.querySelectorAll(":disabled").length&&N.push(":enabled",":disabled"),e.querySelectorAll("*,:x"),N.push(",.*:")
})),(w.matchesSelector=mt.test(R=O.matches||O.webkitMatchesSelector||O.mozMatchesSelector||O.oMatchesSelector||O.msMatchesSelector))&&o(function(e){w.disconnectedMatch=R.call(e,"*"),R.call(e,"[s!='']:x"),L.push("!=",it)}),N=N.length&&new RegExp(N.join("|")),L=L.length&&new RegExp(L.join("|")),t=mt.test(O.compareDocumentPosition),q=t||mt.test(O.contains)?function(e,t){var n=9===e.nodeType?e.documentElement:e,r=t&&t.parentNode;return e===r||!(!r||1!==r.nodeType||!(n.contains?n.contains(r):e.compareDocumentPosition&&16&e.compareDocumentPosition(r)))
}:function(e,t){if(t)for(;t=t.parentNode;)if(t===e)return!0;return!1},V=t?function(e,t){if(e===t)return C=!0,0;var n=!e.compareDocumentPosition-!t.compareDocumentPosition;return n||(1&(n=(e.ownerDocument||e)==(t.ownerDocument||t)?e.compareDocumentPosition(t):1)||!w.sortDetached&&t.compareDocumentPosition(e)===n?e==T||e.ownerDocument==M&&q(M,e)?-1:t==T||t.ownerDocument==M&&q(M,t)?1:A?Z(A,e)-Z(A,t):0:4&n?-1:1)}:function(e,t){if(e===t)return C=!0,0;var n,r=0,i=e.parentNode,o=t.parentNode,a=[e],c=[t];
if(!i||!o)return e==T?-1:t==T?1:i?-1:o?1:A?Z(A,e)-Z(A,t):0;if(i===o)return u(e,t);for(n=e;n=n.parentNode;)a.unshift(n);for(n=t;n=n.parentNode;)c.unshift(n);for(;a[r]===c[r];)r++;return r?u(a[r],c[r]):a[r]==M?-1:c[r]==M?1:0},T):T},n.matches=function(e,t){return n(e,null,null,t)},n.matchesSelector=function(e,t){if(D(e),!(!w.matchesSelector||!j||H[t+" "]||L&&L.test(t)||N&&N.test(t)))try{var r=R.call(e,t);if(r||w.disconnectedMatch||e.document&&11!==e.document.nodeType)return r}catch(e){H(t,!0)}return n(t,T,null,[e]).length>0
},n.contains=function(e,t){return(e.ownerDocument||e)!=T&&D(e),q(e,t)},n.attr=function(e,t){(e.ownerDocument||e)!=T&&D(e);var n=x.attrHandle[t.toLowerCase()],r=n&&U.call(x.attrHandle,t.toLowerCase())?n(e,t,!j):void 0;return void 0!==r?r:w.attributes||!j?e.getAttribute(t):(r=e.getAttributeNode(t))&&r.specified?r.value:null},n.escape=function(e){return(e+"").replace(xt,_t)},n.error=function(e){throw new Error("Syntax error, unrecognized expression: "+e)},n.uniqueSort=function(e){var t,n=[],r=0,i=0;
if(C=!w.detectDuplicates,A=!w.sortStable&&e.slice(0),e.sort(V),C){for(;t=e[i++];)t===e[i]&&(r=n.push(i));for(;r--;)e.splice(n[r],1)}return A=null,e},_=n.getText=function(e){var t,n="",r=0,i=e.nodeType;if(i){if(1===i||9===i||11===i){if("string"==typeof e.textContent)return e.textContent;for(e=e.firstChild;e;e=e.nextSibling)n+=_(e)}else if(3===i||4===i)return e.nodeValue}else for(;t=e[r++];)n+=_(t);return n},(x=n.selectors={cacheLength:50,createPseudo:i,match:dt,attrHandle:{},find:{},relative:{">":{dir:"parentNode",first:!0}," ":{dir:"parentNode"},"+":{dir:"previousSibling",first:!0},"~":{dir:"previousSibling"}},preFilter:{ATTR:function(e){return e[1]=e[1].replace(bt,wt),e[3]=(e[3]||e[4]||e[5]||"").replace(bt,wt),"~="===e[2]&&(e[3]=" "+e[3]+" "),e.slice(0,4)
},CHILD:function(e){return e[1]=e[1].toLowerCase(),"nth"===e[1].slice(0,3)?(e[3]||n.error(e[0]),e[4]=+(e[4]?e[5]+(e[6]||1):2*("even"===e[3]||"odd"===e[3])),e[5]=+(e[7]+e[8]||"odd"===e[3])):e[3]&&n.error(e[0]),e},PSEUDO:function(e){var t,n=!e[6]&&e[2];return dt.CHILD.test(e[0])?null:(e[3]?e[2]=e[4]||e[5]||"":n&&lt.test(n)&&(t=E(n,!0))&&(t=n.indexOf(")",n.length-t)-n.length)&&(e[0]=e[0].slice(0,t),e[2]=n.slice(0,t)),e.slice(0,3))}},filter:{TAG:function(e){var t=e.replace(bt,wt).toLowerCase();return"*"===e?function(){return!0
}:function(e){return e.nodeName&&e.nodeName.toLowerCase()===t}},CLASS:function(e){var t=B[e+" "];return t||(t=new RegExp("(^|"+tt+")"+e+"("+tt+"|$)"))&&B(e,function(e){return t.test("string"==typeof e.className&&e.className||void 0!==e.getAttribute&&e.getAttribute("class")||"")})},ATTR:function(e,t,r){return function(i){var o=n.attr(i,e);return null==o?"!="===t:!t||(o+="","="===t?o===r:"!="===t?o!==r:"^="===t?r&&0===o.indexOf(r):"*="===t?r&&o.indexOf(r)>-1:"$="===t?r&&o.slice(-r.length)===r:"~="===t?(" "+o.replace(ot," ")+" ").indexOf(r)>-1:"|="===t&&(o===r||o.slice(0,r.length+1)===r+"-"))
}},CHILD:function(e,t,n,r,i){var o="nth"!==e.slice(0,3),a="last"!==e.slice(-4),u="of-type"===t;return 1===r&&0===i?function(e){return!!e.parentNode}:function(t,n,c){var s,l,f,d,p,h,g=o!==a?"nextSibling":"previousSibling",m=t.parentNode,v=u&&t.nodeName.toLowerCase(),y=!c&&!u,b=!1;if(m){if(o){for(;g;){for(d=t;d=d[g];)if(u?d.nodeName.toLowerCase()===v:1===d.nodeType)return!1;h=g="only"===e&&!h&&"nextSibling"}return!0}if(h=[a?m.firstChild:m.lastChild],a&&y){for(b=(p=(s=(l=(f=(d=m)[z]||(d[z]={}))[d.uniqueID]||(f[d.uniqueID]={}))[e]||[])[0]===W&&s[1])&&s[2],d=p&&m.childNodes[p];d=++p&&d&&d[g]||(b=p=0)||h.pop();)if(1===d.nodeType&&++b&&d===t){l[e]=[W,p,b];
break}}else if(y&&(b=p=(s=(l=(f=(d=t)[z]||(d[z]={}))[d.uniqueID]||(f[d.uniqueID]={}))[e]||[])[0]===W&&s[1]),!1===b)for(;(d=++p&&d&&d[g]||(b=p=0)||h.pop())&&((u?d.nodeName.toLowerCase()!==v:1!==d.nodeType)||!++b||(y&&((l=(f=d[z]||(d[z]={}))[d.uniqueID]||(f[d.uniqueID]={}))[e]=[W,b]),d!==t)););return(b-=i)===r||b%r==0&&b/r>=0}}},PSEUDO:function(e,t){var r,o=x.pseudos[e]||x.setFilters[e.toLowerCase()]||n.error("unsupported pseudo: "+e);return o[z]?o(t):o.length>1?(r=[e,e,"",t],x.setFilters.hasOwnProperty(e.toLowerCase())?i(function(e,n){for(var r,i=o(e,t),a=i.length;a--;)e[r=Z(e,i[a])]=!(n[r]=i[a])
}):function(e){return o(e,0,r)}):o}},pseudos:{not:i(function(e){var t=[],n=[],r=S(e.replace(at,"$1"));return r[z]?i(function(e,t,n,i){for(var o,a=r(e,null,i,[]),u=e.length;u--;)(o=a[u])&&(e[u]=!(t[u]=o))}):function(e,i,o){return t[0]=e,r(t,null,o,n),t[0]=null,!n.pop()}}),has:i(function(e){return function(t){return n(e,t).length>0}}),contains:i(function(e){return e=e.replace(bt,wt),function(t){return(t.textContent||_(t)).indexOf(e)>-1}}),lang:i(function(e){return ft.test(e||"")||n.error("unsupported lang: "+e),e=e.replace(bt,wt).toLowerCase(),function(t){var n;
do if(n=j?t.lang:t.getAttribute("xml:lang")||t.getAttribute("lang"))return(n=n.toLowerCase())===e||0===n.indexOf(e+"-");while((t=t.parentNode)&&1===t.nodeType);return!1}}),target:function(e){var n=t.location&&t.location.hash;return n&&n.slice(1)===e.id},root:function(e){return e===O},focus:function(e){return e===T.activeElement&&(!T.hasFocus||T.hasFocus())&&!!(e.type||e.href||~e.tabIndex)},enabled:c(!1),disabled:c(!0),checked:function(e){var t=e.nodeName.toLowerCase();return"input"===t&&!!e.checked||"option"===t&&!!e.selected
},selected:function(e){return e.parentNode&&e.parentNode.selectedIndex,!0===e.selected},empty:function(e){for(e=e.firstChild;e;e=e.nextSibling)if(e.nodeType<6)return!1;return!0},parent:function(e){return!x.pseudos.empty(e)},header:function(e){return gt.test(e.nodeName)},input:function(e){return ht.test(e.nodeName)},button:function(e){var t=e.nodeName.toLowerCase();return"input"===t&&"button"===e.type||"button"===t},text:function(e){var t;return"input"===e.nodeName.toLowerCase()&&"text"===e.type&&(null==(t=e.getAttribute("type"))||"text"===t.toLowerCase())
},first:s(function(){return[0]}),last:s(function(e,t){return[t-1]}),eq:s(function(e,t,n){return[0>n?n+t:n]}),even:s(function(e,t){for(var n=0;t>n;n+=2)e.push(n);return e}),odd:s(function(e,t){for(var n=1;t>n;n+=2)e.push(n);return e}),lt:s(function(e,t,n){for(var r=0>n?n+t:n>t?t:n;--r>=0;)e.push(r);return e}),gt:s(function(e,t,n){for(var r=0>n?n+t:n;++r<t;)e.push(r);return e})}}).pseudos.nth=x.pseudos.eq,{radio:!0,checkbox:!0,file:!0,password:!0,image:!0})x.pseudos[b]=function(e){return function(t){return"input"===t.nodeName.toLowerCase()&&t.type===e
}}(b);for(b in{submit:!0,reset:!0})x.pseudos[b]=function(e){return function(t){var n=t.nodeName.toLowerCase();return("input"===n||"button"===n)&&t.type===e}}(b);f.prototype=x.filters=x.pseudos,x.setFilters=new f,E=n.tokenize=function(e,t){var r,i,o,a,u,c,s,l=$[e+" "];if(l)return t?0:l.slice(0);for(u=e,c=[],s=x.preFilter;u;){for(a in r&&!(i=ut.exec(u))||(i&&(u=u.slice(i[0].length)||u),c.push(o=[])),r=!1,(i=ct.exec(u))&&(r=i.shift(),o.push({value:r,type:i[0].replace(at," ")}),u=u.slice(r.length)),x.filter)!(i=dt[a].exec(u))||s[a]&&!(i=s[a](i))||(r=i.shift(),o.push({value:r,type:a,matches:i}),u=u.slice(r.length));
if(!r)break}return t?u.length:u?n.error(e):$(e,c).slice(0)},S=n.compile=function(e,t){var n,r=[],i=[],o=G[e+" "];if(!o){for(t||(t=E(e)),n=t.length;n--;)(o=v(t[n]))[z]?r.push(o):i.push(o);(o=G(e,y(i,r))).selector=e}return o},P=n.select=function(e,t,n,r){var i,o,a,u,c,s="function"==typeof e&&e,f=!r&&E(e=s.selector||e);if(n=n||[],1===f.length){if((o=f[0]=f[0].slice(0)).length>2&&"ID"===(a=o[0]).type&&9===t.nodeType&&j&&x.relative[o[1].type]){if(!(t=(x.find.ID(a.matches[0].replace(bt,wt),t)||[])[0]))return n;
s&&(t=t.parentNode),e=e.slice(o.shift().value.length)}for(i=dt.needsContext.test(e)?0:o.length;i--&&(a=o[i],!x.relative[u=a.type]);)if((c=x.find[u])&&(r=c(a.matches[0].replace(bt,wt),yt.test(o[0].type)&&l(t.parentNode)||t))){if(o.splice(i,1),!(e=r.length&&d(o)))return Q.apply(n,r),n;break}}return(s||S(e,f))(r,t,!j,n,!t||yt.test(e)&&l(t.parentNode)||t),n},w.sortStable=z.split("").sort(V).join("")===z,w.detectDuplicates=!!C,D(),w.sortDetached=o(function(e){return 1&e.compareDocumentPosition(T.createElement("fieldset"))
}),o(function(e){return e.innerHTML="<a href='#'></a>","#"===e.firstChild.getAttribute("href")})||a("type|href|height|width",function(e,t,n){return n?void 0:e.getAttribute(t,"type"===t.toLowerCase()?1:2)}),w.attributes&&o(function(e){return e.innerHTML="<input/>",e.firstChild.setAttribute("value",""),""===e.firstChild.getAttribute("value")})||a("value",function(e,t,n){return n||"input"!==e.nodeName.toLowerCase()?void 0:e.defaultValue}),o(function(e){return null==e.getAttribute("disabled")})||a(et,function(e,t,n){var r;
return n?void 0:!0===e[t]?t.toLowerCase():(r=e.getAttributeNode(t))&&r.specified?r.value:null});var St=t.Sizzle;n.noConflict=function(){return t.Sizzle===n&&(t.Sizzle=St),n},e.exports?e.exports=n:t.Sizzle=n}(window)});nt(nt.S,"Date",{now:function(){return(new Date).getTime()}});var Xi=function(){function e(t){i(this,e),this.config=this._normalize(t),this._store=[],this._ticking=!1,this._lastTimestamp=Date.now(),this._throttledDetect=this._throttledDetect.bind(this)}return a(e,[{key:"_normalize",value:function(e){return"object"!==r(e)&&(e={}),{interval:e.interval||0,offset:e.offset||0,offsetW:e.offsetW||0}
}},{key:"_throttledDetect",value:function(e){var t=this,n=Date.now(),r=n-this._lastTimestamp;this._lastTimestamp=n,!this._ticking&&this._store.length&&r>=this.config.interval&&window.requestAnimationFrame(function(){t._detect(e),t._ticking=!1}),this._ticking=!0}},{key:"_detect",value:function(e){var t=this,n=this._store;k(e)&&(n=this._store.filter(function(t){return t.el.isSameNode(e)})),n.forEach(function(e){S(e.el,t.config.offset,t.config.offsetW)&&e.callback()})}},{key:"addListener",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:function(){};
(e=[].concat(e)).forEach(function(e){k(e)&&(t._store.length||window.addEventListener("scroll",t._throttledDetect),t._store.push({el:e,callback:n}),t._throttledDetect(e))})}},{key:"removeListener",value:function(e){var t=this;(e=[].concat(e)).forEach(function(e){k(e)&&(t._store=t._store.filter(function(t){return!t.el.isSameNode(e)}))}),this._store.length||window.removeEventListener("scroll",this._throttledDetect)}},{key:"removeAllListeners",value:function(){this._store=[],window.removeEventListener("scroll",this._throttledDetect)
}}]),e}(),Qi=new Xi,Yi=[],Zi=!1,eo=[],to=!1,no=Tt(1);nt(nt.P+nt.F*!_t([].map,!0),"Array",{map:function(e){return no(this,e,arguments[1])}});var ro=[],io=!1,oo=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};i(this,e),this.timer=null,this.interval=t.interval||3e3,this.onLog=t.onLog||function(){}}return a(e,[{key:"start",value:function(){var e=this;if(!this.timer){var t=Date.now(),n=g();this.timer=setInterval(function(){var r=Date.now()-t;e.onLog({pageId:n,duration:r})
},this.interval)}}},{key:"stop",value:function(){this.timer&&(clearInterval(this.timer),this.timer=null)}}]),e}(),ao=["appname","device"],uo={viewpage:function(e,t){t({ruleId:e.ruleId,page:e.page},"viewPage")},viewelement:function(e,t){P(e,t),Zi||(Zi=!0,document.addEventListener("DOMNodeInserted",function(){var e=Yi.length;Yi.forEach(function(e){P(e,t)}),Yi.splice(0,e)}))},"viewelement-draw":function(e,t){I(e,t),to||(to=!0,document.addEventListener("DOMNodeInserted",function(){var e=eo.length;eo.forEach(function(e){I(e,t)
}),eo.splice(0,e)}))},actclick:function(e,t){ro.push(e),io||(document.onclick=function(e){io=!0;var n=(e=e||window.event).target||e.srcElement;ro.forEach(function(e){var r=Ki(e.selector),i=e.selector.split(",").map(function(e){return e+" *"}).join(","),o=Ki(i);if(r.indexOf(n)>-1||o.indexOf(n)>-1){var a=e.ruleId,u=e.element,c=e.page,s=e.attribute,l={ruleId:a,element:u,page:c},f=s&&JSON.parse(s);if(f){var d=null;if(d=r.indexOf(n)>-1?n:A(r,n))for(var p in f){var h=d.getAttribute(p);null!==h&&(l[f[p]]=h)
}}t(l,"actClick")}})})},timingpage:function(e,t){var n=e.ruleId,r=e.page,i=new oo({onLog:function(e){t({ruleId:n,page:r,page_id:e.pageId,time_duration:e.duration},"timingPage")}});i.start(),window.addEventListener("unload",function(){return i.stop()})}},co=function(){function e(t){i(this,e),this.globalParam=new Ri,this.baseParam=new Rr,this.platParam=new Ni,this.isWsInit=!1,this.isWsIniting=!1,this.noSendData=[],this.canSocket=!1,this.isWsSupport=!(!window.WebSocket||!window.WebSocket.prototype.send),this.webWocket=new Xn(this.globalParam.getGlobalParam()),this.resolveAuto=this.resolveAutoConfig.bind(this),this.autoLog=this.log.bind(this),this.init(t)
}return a(e,[{key:"isDebug",value:function(){var e=this.globalParam.getGlobalParam().debug;return window.location.href.indexOf("debug=1")>-1&&(e=!0),e}},{key:"init",value:function(e){void 0!==e&&(w(e,ao,this.isDebug())?(this.globalParam.setGlobalParam(e,this.isDebug()),this.baseParam.setBaseParam(e,this.isDebug()),this.platParam.setPlatParam(e,this.isDebug(),!0),this.isInit=!0,e.auto&&e.page&&this.getAutoConfig(e)):this.isDebug()&&console.warn("初始化必填参数不全"))}},{key:"getAutoConfig",value:function(e){var t={appname:e.appname,page:e.page,platform:"web",device:e.device};
this.log({getconfig:t},"getconfig")}},{key:"resolveAutoConfig",value:function(e){var t=this;e&&Array.isArray(e)&&0!==e.length&&e.forEach(function(e){var n=e.atype+e.stype;uo[n]&&uo[n](e,t.autoLog)})}},{key:"setConfig",value:function(e){this.globalParam.setGlobalParam(e,this.isDebug()),this.baseParam.setBaseParam(e,this.isDebug()),this.platParam.setPlatParam(e,this.isDebug()),this.logConfig()}},{key:"initWs",value:function(e){var t=this,n=this.isDebug();return new Promise(function(r,i){t.isWsIniting=!0,t.webWocket.initWebsocket(e,function(){o.canSocket=!0,r()
},function(){o.canSocket=!1,i()},t.resolveAuto,n);var o=t})}},{key:"log",value:function(e,t){var n=this;if(this.isInit)if(p(e)){var r=this.baseParam.getBaseParam(),i=this.platParam.getPlatform(),o=this.platParam.getPlatParam(),a=this.isDebug(),u={baseParam:r,pt:i,ptInfo:o,isDebug:a},c=this.globalParam.getGlobalParam().http.url;this.isWsSupport?this.isWsInit||this.isWsIniting?this.isWsIniting?this.noSendData.push({data:e,type:t}):this.canSocket?this.webWocket.logWebsocket(_(u,e,t),a):f(_(u,e,t,!0),c,this.resolveAuto):this.initWs(x(u)).then(function(){n.isWsInit=!0,n.isWsIniting=!1,n.webWocket.logWebsocket(_(u,e,t),a),n.noSendData.length>0&&(n.noSendData.forEach(function(e){n.webWocket.logWebsocket(_(u,e.data,e.type),a)
}),n.noSendData=[])}).catch(function(){n.isWsInit=!0,n.isWsIniting=!1,f(_(e,t,!0),c,n.resolveAuto),n.noSendData.length>0&&(n.noSendData.forEach(function(e){f(_(u,e.data,e.type,!0),c,n.resolveAuto)}),n.noSendData=[])}):f(_(u,e,t,!0),c,this.resolveAuto)}else this.isDebug()&&console.warn("传入打点参数不是object");else this.isDebug()&&console.warn("发送具体打点之前，请先初始化")}},{key:"logConfig",value:function(){if(this.isWsSupport&&this.isWsInit&&this.canSocket){var e=this.baseParam.getBaseParam(),t=this.platParam.getPlatform(),n=this.platParam.getPlatParam(),r=this.isDebug(),i={baseParam:e,pt:t,ptInfo:n,isDebug:r};
this.webWocket.logWsConfig(x(i),r)}}}]),e}(),so=function(){function e(t){var n;i(this,e),this.log=new co(t),this.logGlobalParam={},void 0!==t&&!1===t.error||(n=this.logEventError.bind(this),window.onerror=function(e,t,r,i,o){n({ruleId:122,msg:encodeURIComponent(e),line:r,col:i,stack:C(o)})})}return a(e,[{key:"init",value:function(e){this.log.init(e)}},{key:"setConfig",value:function(e){this.log.setConfig(e)}},{key:"setLogGlobalParam",value:function(e){this.logGlobalParam=e}},{key:"logEntry",value:function(e,t){this.log.log(n(n({},this.logGlobalParam),e),t)
}},{key:"logViewPage",value:function(e){this.logEntry(e,"viewPage")}},{key:"logViewEl",value:function(e){this.logEntry(e,"viewEl")}},{key:"logViewElDraw",value:function(e){this.logEntry(e,"viewElDraw")}},{key:"logActClick",value:function(e){this.logEntry(e,"actClick")}},{key:"logActVideo",value:function(e){this.logEntry(e,"actVideo")}},{key:"logActScroll",value:function(e){this.logEntry(e,"actScroll")}},{key:"logActEvent",value:function(e){this.logEntry(e,"actEvent")}},{key:"logTimingPage",value:function(e){this.logEntry(e,"timingPage")
}},{key:"logTimingVideo",value:function(e){this.logEntry(e,"timingVideo")}},{key:"logTimingOthers",value:function(e){this.logEntry(e,"timingOthers")}},{key:"logEventError",value:function(e){this.logEntry(e,"eventError")}}]),e}(),lo=new so;e.clickstream=lo,e.default=so,Object.defineProperty(e,"__esModule",{value:!0})}),define("@baidu/clickstream-sdk",["@baidu/clickstream-sdk/lib/index"],function(e){return e});